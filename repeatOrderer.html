<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <!-- Selects the form and handles submission events, passing data to Apps Script. -->
    <script>
        $(document).ready(function(){
        $('select').formSelect();
            });
        function getDepositionData(e) {
            e.preventDefault();
            $("button").attr("disabled", "disabled");
            google.script.run.withSuccessHandler(function () {
                $("button").removeAttr("disabled");
                })
                .getRepeatDepositionData(
                   $('#previousOrderer').val(), 
                   $('#witnessName').val(), 
                   $('#caseStyle').val(), 
                   $('#depoDate').val(), 
                   $('#depoHour').val(), 
                   $('#depoMinute').val(), 
                   $('#amPm').val(), 
                   $('#locationFirm').val(),
                   $('#locationAddress1').val(),
                   $('#locationAddress2').val(),
                   $('#locationCity').val(),
                   $('#locationState').val(),
                   $('#locationZip').val(),
                   $('#locationPhone').val(),
                   $('#services').val(),
                   $('#courtReporter').val(),
                   $('#videographer').val(),
                   $('#pip').prop('checked'),
                   $('#copyAttorney').val(),
                   $('#copyFirm').val(),
                   $('#copyAddress1').val(),
                   $('#copyAddress2').val(),
                   $('#copyCity').val(),
                   $('#copyState').val(),
                   $('#copyZip').val(),
                   $('#copyPhone').val(), 
                   $('#copyEmail').val(),
                   $('#sendConfirmation').prop('checked')
                );
             };
    </script>
</head>

<body>
    <form id="newDepoData" onsubmit="getDepositionData(event)">
        <div class="container">
            <div class="row">
                <h4 class="red-text text-darken-3">Enter a deposition ordered by a repeat client.</h4>
            </div>
            <!-- Order Information -->
            <div class="row">
                <div class="input-field col s12">
                    <select name="previousOrderer" id="previousOrderer">
                    <option value="" disabled selected>Select Previous Orderer</option>
                    <? for (var i = 0; i < orderers.length; i++) { ?>
                        <option value="<?= orderers[i]; ?>"><?= orderers[i]; ?></option>
                        <? } ?>
                    </select>
                    <label for="previousOrderer">Previous Orderer</label>
                </div>
            </div>
            <!-- Deposition Details -->
            <hr class="divider red darken-3">
            <p class="flow-text grey-text">Deposition Details</p>
            <div class="row">
                <div class="input-field col s12">
                    <i class="material-icons prefix">person_outline</i>
                    <input type="text" id="witnessName" name="witnessName">
                    <label for="witnessName">Witness Name</label>
                </div>
            </div>
            <div class="row">
                <div class="input-field col s12">
                    <i class="material-icons prefix">gavel</i>
                    <input type="text" placeholder="e.g. Brown vs. Mayden" id="caseStyle" name="caseStyle">
                    <label for="caseStyle">Case Style</label>
                </div>
            </div>
            <div class="row">
                <div class="input-field col s12">
                    <i class="material-icons prefix">date_range</i>
                    <input type="date" id="depoDate" name="depoDate">
                    <label for="depoDate">Date</label>
                </div>
            </div>
            <div class="row">
                <div class="input-field col s4">
                    <input type="number" value="10" id="depoHour" max="12">
                    <label for="depoHour">Hour</label>
                </div>
                <div class="input-field col s4">
                    <input type="number" value="30" id="depoMinute" max="59">
                    <label for="depoMinute">Minute</label>
                </div>
                <div class="input-field col s4">
                    <select id="amPm">
                        <option value="AM" selected>AM</option>
                        <option value="PM">PM</option>
                    </select>
                </div>
            </div>
            <!-- Location Information -->
            <div class="row">
                <hr class="divider red darken-3">
                <p class="flow-text grey-text">Location Information</p>
                <div class="row">
                    <div class="input-field col s12">
                        <i class="material-icons prefix">business</i>
                        <input type="text" id="locationFirm" name="locationFirm">
                        <label for="locationFirm">Location Firm</label>
                    </div>
                </div>
                <div class="row">
                    <div class="input-field col s12">
                        <i class="material-icons prefix">add_location</i>
                        <input type="text" id="locationAddress1" name="locationAddress1">
                        <label for="locationAddress1">Location Address 1</label>
                    </div>
                </div>
                <div class="row">
                    <div class="input-field col s12">
                        <i class="material-icons prefix">add_location</i>
                        <input type="text" id="locationAddress2" name="locationAddress2">
                        <label for="locationAddress2">Location Address 2</label>
                    </div>
                </div>
                <div class="row">
                    <div class="input-field col s6">
                        <input type="text" value="San Antonio" id="locationCity" name="locationCity">
                        <label for="locationCity">City</label>
                    </div>
                    <div class="input-field col s2">
                        <input type="text" value="TX" id="locationState" name="locationState">
                        <label for="locationState">State</label>
                    </div>
                    <div class="input-field col s4">
                        <input type="text" placeholder="78232" id="locationZip" name="locationZip">
                        <label for="locationZip">Zip</label>
                    </div>
                </div>
                <div class="row">
                    <div class="input-field col s12">
                        <i class="material-icons prefix">phone</i>
                        <input type="text" id="locationPhone" name="locationPhone">
                        <label for="locationPhone">Location Phone Number</label>
                    </div>
                </div>
            </div>
            <!-- Services -->
            <div class="row">
                <hr class="divider red darken3">
                <p class="flow-text grey-text">Services Included</p>
                <div class="row">
                    <div class="input-field col s12">
                        <i class="material-icons prefix">burst_mode</i>
                        <input type="text" id="services" name="services">
                        <label for="services">Service Description</label>
                    </div>
                </div>
                <div class="row">
                    <div class="input-field col s12">
                        <i class="material-icons prefix">format_align_justify</i>
                        <input type="text" id="courtReporter" name="courtReporter">
                        <label for="courtReporter">Court Reporter</label>
                    </div>
                </div>
                <div class="row">
                    <div class="input-field col s9">
                        <i class="material-icons prefix">videocam</i>
                        <input type="text" id="videographer" name="videographer">
                        <label for="videographer">Videographer</label>
                    </div>
                    <div class="input-field col s2">
                        <label>
                            <input type="checkbox" id="pip" />
                            <span>PIP</span>
                        </label>
                    </div>
                </div>
            </div>
            <!-- Copy Attorney Information -->
            <hr class="divider red darken-3">
            <div class="row">
                <p class="flow-text grey-text">Copy Attorney Information</p>
                <blockquote>
                    Leave section blank if no copy attorney.<br>
                    ⬇️ Select from dropdown to autofill previous copy attorney.
                </blockquote>
                <div class="row">
                    <div class="input-field col s12">
                    <select class="prevCopyAtty" name="prevCopyAtty" id="prevCopyAtty">
                    <option value="" disabled selected>Select Copy Attorney</option>
                        <? for (var i = 0; i < copyAttys.length; i++) { ?>
                            <option value="<?= i; ?>"><?= copyAttys[i][0]; ?></option>
                        <? } ?>
                    </select>
              </div>
            </div>
                <div class="row">
                    <div class="input-field col s12">
                        <i class="material-icons prefix">content_copy</i>
                        <input type="text" id="copyAttorney" name="copyAttorney">
                    </div>
                        <label class="right" for="copyAttorney">Copy Attorney</label>
                </div>
                <div class="row">
                    <div class="input-field col s12">
                        <i class="material-icons prefix">content_copy</i>
                        <input type="text" id="copyFirm" name="copyFirm">
                    </div>
                        <label class="right" for="copyFirm">Copy Firm</label>
                </div>
                <div class="row">
                    <div class="input-field col s12">
                        <i class="material-icons prefix">content_copy</i>
                        <input type="text" id="copyAddress1" name="copyAddress1">
                    </div>
                        <label class="right" for="copyAddress1">Copy Firm Address 1</label>
                </div>
                <div class="row">
                    <div class="input-field col s12">
                        <i class="material-icons prefix">content_copy</i>
                        <input type="text" id="copyAddress2" name="copyAddress2">
                    </div>
                        <label class="right" for="copyAddress2">Copy Firm Address 2</label>
                </div>
                <div class="row">
                    <div class="input-field col s6">
                        <input type="text" placeholder="San Antonio" id="copyCity" name="copyCity">
                        <label for="copyCity">City</label>
                    </div>
                    <div class="input-field col s2">
                        <input type="text" placeholder="TX" id="copyState" name="copyState">
                        <label for="copyState">State</label>
                    </div>
                    <div class="input-field col s4">
                        <input type="text" placeholder="78232" id="copyZip" name="copyZip">
                        <label for="copyZip">Zip</label>
                    </div>
                </div>
                <div class="row">
                    <div class="input-field col s12">
                        <i class="material-icons prefix">content_copy</i>
                        <input type="text" id="copyPhone" name="copyPhone">
                    </div>
                        <label class="right" for="copyPhone">Copy Attorney Phone</label>
                </div>
                <div class="row">
                    <div class="input-field col s12">
                        <i class="material-icons prefix">content_copy</i>
                        <input type="email" class="validate" id="copyEmail" name="copyEmail">
                    </div>
                        <label class="right" for="copyEmail">Copy Attorney Email</label>
                </div>
            </div>
            <!-- Confirmation Email Option -->
            <div class="row">
                <hr class="divider red darken3">
                <div class="row">
                    <div class="input-field col s12">
                    <label>
                        <input type="checkbox" id="sendConfirmation" />
                        <span>Send confirmation email to orderer?</span>
                        </label>
                    </div>
                </div>
            </div>
            <!-- Buttons -->
            <div class="row">
                <div class="col s12 center">
                    <button class="btn" type="submit">Save Deposition</button>
                </div>
            </div>
        </div>
    </form>

    <!-- Dynamically prints copy attorney names and hides them. -->
    <? for (var i = 0; i < copyAttys.length; i++) { ?>
      <div class="copy-names" style='display:none;'><?= copyAttys[i][0]; ?></div>
    <? } ?>

    <!-- Dynamically prints copy attorney firms and hides them. -->
    <? for (var i = 0; i < copyAttys.length; i++) { ?>
      <div class="copy-firms" style='display:none;'><?= copyAttys[i][1]; ?></div>
    <? } ?>
    
    <!-- Dynamically prints copy attorney firm address (1) and hides them. -->
    <? for (var i = 0; i < copyAttys.length; i++) { ?>
      <div class="copy-firm-addresses-1" style='display:none;'><?= copyAttys[i][2]; ?></div>
    <? } ?>
    
    <!-- Dynamically prints copy attorney firm address (2) and hides them. -->
    <? for (var i = 0; i < copyAttys.length; i++) { ?>
      <div class="copy-firm-addresses-2" style='display:none;'><?= copyAttys[i][3]; ?></div>
    <? } ?>
    
    <!-- Dynamically prints copy attorney cities and hides them. -->
    <? for (var i = 0; i < copyAttys.length; i++) { ?>
      <div class="copy-cities" style='display:none;'><?= copyAttys[i][4]; ?></div>
    <? } ?>
    
    <!-- Dynamically prints copy attorney states and hides them. -->
    <? for (var i = 0; i < copyAttys.length; i++) { ?>
      <div class="copy-states" style='display:none;'><?= copyAttys[i][5]; ?></div>
    <? } ?>
    
    <!-- Dynamically prints copy attorney zip codes and hides them. -->
    <? for (var i = 0; i < copyAttys.length; i++) { ?>
      <div class="copy-zips" style='display:none;'><?= copyAttys[i][6]; ?></div>
    <? } ?>
    
    <!-- Dynamically prints copy attorney phone numbers and hides them. -->
    <? for (var i = 0; i < copyAttys.length; i++) { ?>
      <div class="copy-phones" style='display:none;'><?= copyAttys[i][7]; ?></div>
    <? } ?>
    
    <!-- Dynamically prints copy attorney email addresses and hides them. -->
    <? for (var i = 0; i < copyAttys.length; i++) { ?>
      <div class="copy-emails" style='display:none;'><?= copyAttys[i][8]; ?></div>
    <? } ?>
    
    <!-- Populates copy attorney information on user selection. -->
    <script>
    // Zip Phone, Email
    $(".prevCopyAtty").change(function() {
      /** Gets index of user selection in the copy attorneys array. */
      var selection = $('.prevCopyAtty').val();
      
      /** Gathers arrays of copy attorney array elements. */
      var names = $(".copy-names").get();
      var firms = $(".copy-firms").get();
      var firmAddresses1 = $(".copy-firm-addresses-1").get();
      var firmAddresses2 = $(".copy-firm-addresses-2").get();
      var copyCities = $(".copy-cities").get();
      var copyStates = $(".copy-states").get();
      var copyZips = $(".copy-zips").get();
      var copyPhones = $(".copy-phones").get();
      var copyEmails = $(".copy-emails").get();
      
      /** Sets values of form fields based on index user has selected. */
      $('#copyAttorney').val(names[selection].innerHTML);
      $('#copyFirm').val(firms[selection].innerHTML);
      $('#copyAddress1').val(firmAddresses1[selection].innerHTML);
      $('#copyAddress2').val(firmAddresses2[selection].innerHTML);
      $('#copyCity').val(copyCities[selection].innerHTML);
      $('#copyState').val(copyStates[selection].innerHTML);
      $('#copyZip').val(copyZips[selection].innerHTML);
      $('#copyPhone').val(copyPhones[selection].innerHTML);
      $('#copyEmail').val(copyEmails[selection].innerHTML);
    });
    </script>
</body>
</html>